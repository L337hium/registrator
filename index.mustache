<!DOCTYPE html>
<html>
  <head>
    <title>{{name}}> {{network.name}}</title>

    <!-- generic webapp shit-->
    <link href='http://localhost:8000/style.css' rel='stylesheet' type='text/css'>
    
  </head>
  <body>
    <style type="text/css">    
    header, section, article, footer {
      min-width: 520px;
      max-width: 780px;
    }
    .table, #console {
      font-size: 11pt;
    }
    .table td, #console {
      font-family: 'Source Code Pro', sans-serif;
    }
    .table tr, .table td {
      font-weight: normal;
    }
    #console {
      text-align: left;
      height: 113px;
      overflow: scroll;
    }
    #console .event {
    font-weight: bold;
    }
    .tooltip.in {
    opacity: 1;
    filter: none;
    }
    </style>
    
    <header>
      <h1><i class="icon-list-ol"></i> {{name}}</h1>
    </header>

    <section id="content">
      {{#network}}
      {{#active}}
      
      <h3 class="lead">
        network: <kbd>{{name}}
          <small><a href="{{url}}" title="{{name}} Website">
            <i class="icon-external-link"></i>
          </a></small>
        </kbd>
      </h3>
      
      <table id="network" class="table table-condensed table-bordered golden-big">
        <tr>
          <th>range</th>
          <th>lease days</th>
          <th>listings</th>
        </tr>
        <tr>
          <td>
            <kbd>{{minimum}}..{{maximum}}</kbd> 
          </td>
          <td>
            <kbd>
              {{#lease_days}}{{lease_days}}{{/lease_days}}
              {{^lease_days}}unknown!{{/lease_days}}
            </kbd> 
          </td>
          <td>
            <kbd>
              <a href="/list/number" title="Numbers Listing">&#x2116;</a>, 
              <a href="/list/mac" title="MAC Listing">MAC</a>
            </kbd> 
          </td>
        </tr>
      </table>
      {{/active}}
      {{/network}}
      
      <hr>
      
      <h4>
        Konsole
        <!-- <button type="button" class="btn btn-link" data-toggle="collapse" data-target="#console-container">
          <i class="icon icon-resize-small"></i>
        </button> -->
      </h4>
      <div id="console-container">
        <div id="console" class="well dark">
      </div>
      </div>
      
      <hr>
            
      <h4>Knoten</h4>
      <table id="knoten-listing" class="table table-hover">
        <tr>
          
          <th>&#x2116;</th>
          <th>MAC</th>
          <th>created at</th>
          <th>last seen <i class="icon-angle-down"></i></th>
          
        </tr>
        
        {{#knoten}}
        <tr id="knoten-nr-{{number}}">
          <td class="knoten-number">
            <a href="/GET/knoten/{{number}}">
              {{number}}
            </a>
          </td>
          <td class="knoten-mac">
            {{mac}}
          </td>
          <td class="knoten-created_at">
            {{created_at}}
          </td>   
          <td class="knoten-last_seen">
           {{last_seen}}
          </td>   
        </tr>
        {{/knoten}}

      </table>
      
    </section>
    
    <footer>
      <kbd>{{name}}.js running on dev.</kbd>
    </footer>
    
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/js/bootstrap.min.js"></script>
    
    <script src="/plates.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    
    <script>
      $(function(){
        $('#console').tooltip({
          selector: "span[data-toggle=tooltip]"
        });
        // $("body").tooltip();
        // $('body').on('.tooltip.data-api');
        console.log('tooltips!');
      });
    
      var socket = io.connect('http://thirtyhundred.127.0.0.1.xip.io');
      
      socket.on('console', function (data) {
        
        var now = new Date();
        data.timestamp = now.getTime();
        data.timestampISO = now.toISOString();
        console.log(data);
        
        // console updates
        $(function() {

          var html = '<p class="logentry"><span class="timestamp label label-info" data-toggle="tooltip" title=""></span> <span class="event"></span>: <span class="message"></span> </p>';
          
          var map = new Plates.Map();
          
          map.class('event').to('event');
          map.class('message').to('message');
          map.class('timestamp').to('timestamp');          
          map.where('data-toggle').is('tooltip')
            .use('timestampISO').as('title');
          map.where('')

          var output = Plates.bind(html, data, map);
          console.log(output);
          $('#console').prepend(output);
          // $('#console').html();

        });
      
      });
      
  </script>
    
  </body>
</html>
